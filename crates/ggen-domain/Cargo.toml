[package]
name = "ggen-domain"
version = "3.2.0"
authors = ["Sean Chatman <sean@chatmangpt.com>"]
description = "Domain logic layer for ggen - pure business logic without CLI dependencies"
edition = "2021"
license = "MIT"
repository = "https://github.com/seanchatmangpt/ggen"
homepage = "https://github.com/seanchatmangpt/ggen"
keywords = ["code-generation", "rdf", "templates", "domain"]
categories = ["development-tools"]

[lints.clippy]
multiple_crate_versions = "allow"

[dependencies]
# Workspace dependencies
tokio = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
serde_yaml = { workspace = true }
thiserror = { workspace = true }

# Local infrastructure dependencies (use workspace = true pattern)
ggen-core.workspace = true
ggen-ai.workspace = true
ggen-marketplace.workspace = true
ggen-utils.workspace = true
ggen-marketplace-v2 = { path = "../ggen-marketplace-v2", version = "3.0.0", optional = true }

# Crate-specific dependencies
tera = { workspace = true }
toml = { workspace = true }
oxigraph = { workspace = true }
regex = { workspace = true }
chrono = { workspace = true }
uuid = { workspace = true }
rayon = { workspace = true }
tracing = { workspace = true }
once_cell = { workspace = true }
walkdir = "2.5"
glob = "0.3"
sha2 = "0.10"
md5 = "0.8"
tempfile = { workspace = true }
tar = "0.4"
flate2 = "1.0"
dirs = "5.0"
reqwest = { workspace = true }
zip = "0.6"
fastrand = "2.3"                 # Lightweight RNG for jitter in retry logic
async-trait = "0.1"

# CRITICAL: NO clap or clap-noun-verb dependencies
# Domain must be CLI-agnostic

[features]
# Marketplace backend selection (for gradual v1â†’v2 migration)
marketplace-v1 = []                           # Legacy marketplace (default)
marketplace-v2 = ["ggen-marketplace-v2"]     # RDF-backed marketplace (new)
marketplace-parallel = ["marketplace-v1", "marketplace-v2"]  # Both for A/B testing

# Default to v1 for backward compatibility
default = ["marketplace-v1"]

[dev-dependencies]
assert_cmd = "2"
assert_fs = "1"
predicates = "3"
tempfile = { workspace = true }
tokio-test = "0.4"
chicago-tdd-tools = { version = "1.4.0", features = ["testing-extras"] }
criterion = { version = "0.7", features = ["html_reports"] }

[[bench]]
name = "swarm_primitives"
harness = false
