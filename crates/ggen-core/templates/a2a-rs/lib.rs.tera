use std::fmt;
{% for type in types %}
/// {{ type.description | trim }}
#[{{ type.visibility | default("pub") }}]
{{ type.name }}{% if type.derive %}
#[derive({{ type.derive | join(", ") }})]{% endif %}{% if type.struct %} {
    {% for field in type.fields %}
    /// {{ field.description | trim }}
    {{ field.visibility | default("pub") }} {{ field.name }}: {{ field.type }}{% if field.default %} = {{ field.default }}{% endif %},
    {% endfor %}
}
{% else if type.enum %}
{
    {% for variant in type.variants %}
    {% if variant.rename %} #[serde(rename = "{{ variant.rename }}")] {% endif %}{{ variant.name }},{% endfor %}
}
{% else if type.union %}
{%- for field in type.fields %}
    {{ field.name }}({{ field.type }}),
{%- endfor %}
}
{%- endif %}

impl fmt::Debug for {{ type.name }} {
    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {
        match self {
            {% for variant in type.variants | default([]) %}
            {{ type.name }}::{{ variant.name }} => write!(f, "{{ variant.name }}"),
            {% endfor %}
            {% for field in type.fields | default([]) %}
            {{ type.name }}::{{ field.name }}(inner) => write!(f, "{{ type.name }}({{:?}})", inner),
            {% endfor %}
            {% if not type.enum and not type.union and not type.variants %}
            _ => f.debug_struct("{{ type.name }}")
                {% for field in type.fields | default([]) %}
                .field("{{ field.name }}", &self.{{ field.name }})
                {% endfor %}
                .finish(),
            {% endif %}
        }
    }
}

{% endfor %}