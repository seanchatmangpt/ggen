# =============================================================================
# MCP+ Contract Family Configuration
#
# Contract families group related contracts for governance.
# Kill switch operates at family level for bulk control.
#
# Core axiom: A = μ(O), μ ∘ μ = μ, hash(A) = hash(μ(O)), O ⊨ Σ
#
# Generated by ggen - DO NOT EDIT MANUALLY
# Regenerate with: ggen sync --audit true
# =============================================================================

[families]
version = "1.0.0"

# -----------------------------------------------------------------------------
# Tier A Contract Families (Automate)
# -----------------------------------------------------------------------------

[families.onboarding]
id = "onboarding"
name = "Customer Onboarding"
tier = "tier_a"
description = "Automated customer onboarding and verification workflows"

[families.onboarding.envelope]
inherit = "tier_a"
max_duration_ms = 45000
scopes = ["customer_data", "verification"]
capabilities = ["read", "write", "validate", "notify"]

[families.onboarding.governance]
owner = "customer_operations"
approval_required = false
audit_frequency = "monthly"

# -----------------------------------------------------------------------------

[families.reconciliation]
id = "reconciliation"
name = "Financial Reconciliation"
tier = "tier_a"
description = "Automated reconciliation and exception routing"

[families.reconciliation.envelope]
inherit = "tier_a"
max_duration_ms = 120000
scopes = ["financial_data", "audit_trail"]
capabilities = ["read", "query", "reconcile", "notify"]

[families.reconciliation.governance]
owner = "finance_operations"
approval_required = false
audit_frequency = "weekly"
dual_control = true

# -----------------------------------------------------------------------------

[families.claims_triage]
id = "claims_triage"
name = "Claims Triage"
tier = "tier_a"
description = "Automated claims triage and routing (not adjudication)"

[families.claims_triage.envelope]
inherit = "tier_a"
max_duration_ms = 30000
scopes = ["claims_data"]
capabilities = ["read", "classify", "route", "notify"]

[families.claims_triage.governance]
owner = "claims_operations"
approval_required = false
audit_frequency = "daily"

# -----------------------------------------------------------------------------

[families.vendor_validation]
id = "vendor_validation"
name = "Vendor Validation"
tier = "tier_a"
description = "Automated vendor onboarding and catalog validation"

[families.vendor_validation.envelope]
inherit = "tier_a"
max_duration_ms = 60000
scopes = ["vendor_data", "catalog_data"]
capabilities = ["read", "validate", "verify", "notify"]

[families.vendor_validation.governance]
owner = "procurement"
approval_required = false
audit_frequency = "monthly"

# -----------------------------------------------------------------------------

[families.compliance_reporting]
id = "compliance_reporting"
name = "Compliance Reporting"
tier = "tier_a"
description = "Automated compliance report generation and evidence export"

[families.compliance_reporting.envelope]
inherit = "tier_a"
max_duration_ms = 300000           # 5 minutes for large reports
scopes = ["audit_trail", "compliance_data"]
capabilities = ["read", "query", "aggregate", "export"]

[families.compliance_reporting.governance]
owner = "compliance"
approval_required = false
audit_frequency = "continuous"

# -----------------------------------------------------------------------------
# Tier B Contract Families (Assist)
# -----------------------------------------------------------------------------

[families.customer_disputes]
id = "customer_disputes"
name = "Customer Dispute Handling"
tier = "tier_b"
description = "Human-supervised dispute analysis and resolution assistance"

[families.customer_disputes.envelope]
inherit = "tier_b"
max_duration_ms = 180000
scopes = ["customer_data", "dispute_data"]
capabilities = ["read", "query", "analyze", "suggest", "draft"]

[families.customer_disputes.governance]
owner = "customer_service"
approval_required = true
human_reviewer = true
audit_frequency = "per_case"

# -----------------------------------------------------------------------------

[families.complex_adjudication]
id = "complex_adjudication"
name = "Complex Claims Adjudication"
tier = "tier_b"
description = "Human-supervised complex claims analysis"

[families.complex_adjudication.envelope]
inherit = "tier_b"
max_duration_ms = 300000
scopes = ["claims_data", "policy_data", "medical_data"]
capabilities = ["read", "query", "analyze", "recommend"]

[families.complex_adjudication.governance]
owner = "claims_adjudication"
approval_required = true
human_reviewer = true
specialist_review = true
audit_frequency = "per_case"

# -----------------------------------------------------------------------------

[families.fraud_detection]
id = "fraud_detection"
name = "Novel Fraud Detection"
tier = "tier_b"
description = "Human-supervised analysis of potential fraud patterns"

[families.fraud_detection.envelope]
inherit = "tier_b"
max_duration_ms = 120000
scopes = ["transaction_data", "customer_data", "fraud_patterns"]
capabilities = ["read", "query", "analyze", "flag", "recommend"]

[families.fraud_detection.governance]
owner = "fraud_prevention"
approval_required = true
human_reviewer = true
escalation_required = true
audit_frequency = "per_case"

# -----------------------------------------------------------------------------
# Family-Level Kill Switch Configuration
# -----------------------------------------------------------------------------

[families.kill_switch]
enabled = true
propagation = "immediate"

# Kill switch recovery requires explicit re-enablement
[families.kill_switch.recovery]
requires_approval = true
approval_roles = ["contract_authority", "risk_officer"]
cool_down_minutes = 5

# -----------------------------------------------------------------------------
# Family Metrics
# -----------------------------------------------------------------------------

[families.metrics]
enabled = true
collect_interval_ms = 1000

[families.metrics.per_family]
operations_count = true
success_rate = true
refusal_rate = true
avg_duration_ms = true
envelope_utilization = true

[families.metrics.alerts]
success_rate_threshold = 0.95
refusal_rate_threshold = 0.10
duration_threshold_multiplier = 1.5
