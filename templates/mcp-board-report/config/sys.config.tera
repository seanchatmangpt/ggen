%% =============================================================================
%% MCP+ Erlang System Configuration
%%
%% Core axiom: A = μ(O), μ ∘ μ = μ, hash(A) = hash(μ(O)), O ⊨ Σ
%%
%% Generated by ggen - DO NOT EDIT MANUALLY
%% Regenerate with: ggen sync --audit true
%% =============================================================================

[
    %% MCP Application Configuration
    {mcp, [
        %% Default envelope bounds
        {default_time_bound_ms, {{ default_time_bound_ms | default(value=30000) }}},
        {default_resource_bound_bytes, {{ default_resource_bound_bytes | default(value=104857600) }}},

        %% Kill switch configuration
        {kill_switch_enabled, true},
        {kill_switch_fail_closed, true},

        %% Receipt chain configuration
        {receipt_chain_enabled, true},
        {receipt_storage_path, "{{ receipt_storage_path | default(value='/var/lib/mcp/receipts') }}"},
        {receipt_hash_algorithm, sha256},

        %% Evidence bundle configuration
        {evidence_bundle_path, "{{ evidence_bundle_path | default(value='/var/lib/mcp/bundles') }}"},
        {evidence_bundle_version, <<"1.0.0">>},

        %% Key management
        {hsm_enabled, {{ hsm_enabled | default(value="false") }}},
        {key_epoch_rotation_days, {{ key_epoch_rotation_days | default(value=90) }}},

        %% NIF configuration
        {nif_dirty_scheduler, true},
        {nif_panic_catch, true}
    ]},

    %% Kernel Configuration
    {kernel, [
        {logger_level, {{ logger_level | default(value="info") }}},
        {logger, [
            {handler, default, logger_std_h, #{
                level => {{ logger_level | default(value="info") }},
                formatter => {logger_formatter, #{
                    template => [time, " [", level, "] ", msg, "\n"],
                    single_line => true
                }}
            }},
            {handler, file, logger_std_h, #{
                level => {{ logger_level | default(value="info") }},
                config => #{
                    file => "{{ log_file | default(value='/var/log/mcp/mcp.log') }}",
                    max_no_bytes => 10485760,  % 10 MB
                    max_no_files => 10
                },
                formatter => {logger_formatter, #{
                    template => [time, " [", level, "] ", pid, " ", msg, "\n"],
                    single_line => true
                }}
            }}
        ]}
    ]},

    %% SASL Configuration
    {sasl, [
        {sasl_error_logger, {file, "{{ sasl_log | default(value='/var/log/mcp/sasl.log') }}"}},
        {errlog_type, error},
        {error_logger_mf_dir, "{{ error_log_dir | default(value='/var/log/mcp/error') }}"},
        {error_logger_mf_maxbytes, 10485760},
        {error_logger_mf_maxfiles, 10}
    ]},

    %% Lager Configuration (if used)
    {lager, [
        {handlers, [
            {lager_console_backend, [
                {level, {{ lager_level | default(value="info") }}},
                {formatter, lager_default_formatter},
                {formatter_config, [
                    time, " [", severity, "] ", pid, " ", message, "\n"
                ]}
            ]},
            {lager_file_backend, [
                {file, "{{ lager_log | default(value='/var/log/mcp/lager.log') }}"},
                {level, {{ lager_level | default(value="info") }}},
                {size, 10485760},
                {count, 10},
                {formatter, lager_default_formatter},
                {formatter_config, [
                    date, " ", time, " [", severity, "] ", pid, " ", message, "\n"
                ]}
            ]}
        ]},
        {crash_log, "{{ crash_log | default(value='/var/log/mcp/crash.log') }}"},
        {crash_log_size, 10485760},
        {crash_log_count, 5},
        {error_logger_redirect, true}
    ]}
].
