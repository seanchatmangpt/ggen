%% ============================================================================
%% {{ module_name }} - Generated from RDF specification
%% ============================================================================
%% {{ description }}
%%
%% This module was generated by ggen from an RDF ontology.
%% The 20% that matters: module + behavior + state + callbacks.

-module({{ module_name }}).
-behaviour(gen_server).

%% API
-export([start_link/0]).
{% for func in api_functions -%}
-export([{{ func.name }}/{{ func.arity }}]).
{% endfor %}

%% gen_server callbacks
-export([init/1, handle_call/3, handle_cast/2, handle_info/2, terminate/2, code_change/3]).

-record(state, {
    {{ state_fields }} :: integer()
}).

%% ============================================================================
%% API
%% ============================================================================

start_link() ->
    gen_server:start_link({local, ?MODULE}, ?MODULE, [], []).

{% for func in api_functions -%}
{% if func.type == "call" -%}
{{ func.name }}() ->
    gen_server:call(?MODULE, {{ func.name }}).
{% elif func.type == "cast" -%}
{{ func.name }}() ->
    gen_server:cast(?MODULE, {{ func.name }}).
{% endif %}

{% endfor %}

%% ============================================================================
%% gen_server callbacks
%% ============================================================================

init([]) ->
    {ok, #state{ {{ state_fields }} = {{ initial_state }} }}.

{% for func in api_functions -%}
{% if func.type == "call" -%}
handle_call({{ func.name }}, _From, #state{ {{ state_fields }} = Count } = State) ->
{% if func.name == "increment" -%}
    NewCount = Count + 1,
    {reply, {ok, NewCount}, State#state{ {{ state_fields }} = NewCount }};
{% elif func.name == "get_count" -%}
    {reply, {ok, Count}, State};
{% else -%}
    {reply, ok, State};
{% endif %}
{% endif %}
{% endfor %}

handle_call(_Request, _From, State) ->
    {reply, {error, unknown_call}, State}.

{% for func in api_functions -%}
{% if func.type == "cast" -%}
handle_cast({{ func.name }}, State) ->
{% if func.name == "reset" -%}
    {noreply, State#state{ {{ state_fields }} = 0 }};
{% else -%}
    {noreply, State};
{% endif %}
{% endif %}
{% endfor %}

handle_cast(_Msg, State) ->
    {noreply, State}.

handle_info(_Info, State) ->
    {noreply, State}.

terminate(_Reason, _State) ->
    ok.

code_change(_OldVsn, State, _Extra) ->
    {ok, State}.
