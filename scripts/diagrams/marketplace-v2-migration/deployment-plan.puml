@startuml deployment-plan
!theme plain
skinparam backgroundColor #FEFEFE
skinparam shadowing false

title **Marketplace-V2: Deployment & Release Plan**\n<size:12>//From Integration to Production Release//</size>

|Release Manager|
start

partition "Pre-Deployment Validation" #FFE4E4 {
    :Final build verification;
    note right: cargo make ci
            cargo make release-validate
            All SLOs verified
    
    :Documentation complete;
    note right: README.md updated
            MIGRATION_GUIDE.md created
            API docs generated
    
    :Release notes prepared;
    note right: Summarize changes
            Highlight new features
            Note breaking changes
}

partition "Version Management" #FFF4E4 {
    :Update version numbers;
    note right: **Files to update:**
            - Cargo.toml (marketplace-v2 to v3.0.0)
            - Cargo.toml (ggen main to v3.3.1)
            - src/lib.rs (version)
            - docs/VERSION.md
    
    :Update changelog;
    note right: **CHANGELOG.md:**
            ## [3.0.0] - 2024-XX-XX
            
            ### Added
            - Marketplace-v2 CLI integration
            - ggen marketplace install command
            - ggen marketplace search command
            - etc...
            
            ### Fixed
            - Resolved 128 compilation errors
            - Fixed trait bounds issues
            - Fixed async/await integration
            
            ### Changed
            - Marketplace API v2→v3
            - RDF storage with oxigraph
            - SPARQL query engine
}

partition "Release Branching & Tagging" #FFFBE4 {
    :Create release branch;
    note right: git checkout -b release/v3.0.0
    
    :Update version in all files;
    note right: git commit -m "chore: bump version to 3.0.0"
    
    :Create release tag;
    note right: git tag -a v3.0.0 -m "Release marketplace-v2 integration"
    
    :Push to remote;
    note right: git push origin release/v3.0.0
            git push origin v3.0.0
}

partition "CI/CD Pipeline" #E4FFE4 {
    :Trigger CI on release tag;
    note right: GitHub Actions workflow
            cargo make ci
            All tests pass
            All checks pass
    
    if (CI passes?) then (yes)
        :Build release binary;
        note right: cargo build --release
                Size optimization
                Strip debug symbols
    else (fails)
        |Debugger|
        :Fix issues;
        :(back to CI trigger)
    endif
    
    :Run security scan;
    note right: cargo audit
            cargo outdated
            Review dependencies
    
    if (Security OK?) then (yes)
        :Proceed to artifacts;
    else (vulnerabilities found)
        |Security|
        :Address vulnerabilities;
        :(back to security)
    endif
}

partition "Artifact Generation" #FFF4E4 {
    :Generate binary artifacts;
    note right: Linux x86_64
            macOS x86_64
            macOS ARM64 (Apple Silicon)
            Windows x86_64
    
    :Generate source tarball;
    note right: ggen-v3.0.0.tar.gz
    
    :Generate checksums;
    note right: SHA256SUMS
            GPG sign checksums
    
    :Create release on GitHub;
    note right: Release notes
            Binary downloads
            Checksum verification
}

partition "Distribution & Announcement" #FFE4E4 {
    :Update package managers;
    note right: **Homebrew (macOS):**
            brew bump-formula-pr ggen
            
            **Cargo (Rust):**
            cargo publish
            
            **APT (Linux):**
            Update package repository
    
    :Announce release;
    note right: **Channels:**
            - GitHub Releases page
            - ggen documentation
            - Release blog post
            - Twitter/Social media
            - Community forums
    
    :Update documentation site;
    note right: Installation instructions
            Marketplace-v2 features
            Migration guide
            API reference
}

partition "Post-Release Monitoring" #E4F4FF {
    :Monitor download statistics;
    note right: Track adoption rate
            Identify issues
            Gather feedback
    
    :Monitor issue reports;
    note right: GitHub Issues
            User feedback
            Bug reports
    
    :Prepare hotfix branch;
    note right: If critical issues found
            Create release/v3.0.1
            Fix issues
            Re-release
    
    if (Critical issues?) then (yes)
        |Hotfix Team|
        :Create hotfix;
        note right: git checkout -b hotfix/v3.0.1
        :Apply fix;
        :Test thoroughly;
        :Release v3.0.1;
        :(back to post-release monitoring)
    else (all good)
        :Close release process;
        :Begin next iteration;
    endif
}

|Release Manager|
:Release COMPLETE ✓;
stop

legend right
    <b>Deployment Checklist</b>
    |= Item |= Status |
    | All tests PASSING | ✓ |
    | No compiler warnings | ✓ |
    | Security audit OK | ✓ |
    | Documentation complete | ✓ |
    | Release notes written | ✓ |
    | Changelog updated | ✓ |
    | Artifacts generated | ✓ |
    | Announcement ready | ✓ |
    | Monitoring set up | ✓ |
endlegend

@enduml
