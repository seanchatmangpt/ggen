{erl_opts, [
    debug_info,
    warn_missing_spec,
    warn_unused_vars
]}.

{deps, [
    %% HTTP Server
    {cowboy, "2.10.0"},
    
    %% JSON Parsing
    {jsx, "3.1.0"},
    
    %% JWT/Signature Verification
    {jose, "1.11.5"},
    
    %% Process Registry
    {gproc, "0.9.0"},
    
    %% Worker Pool
    {poolboy, "1.5.2"},
    
    %% Metrics
    {prometheus, "4.9.0"},
    
    %% Tracing
    {opentelemetry, "1.3.0"},
    {opentelemetry_api, "1.2.0"},
    
    %% Runtime Debugging (optional)
    {recon, "2.5.2"}
]}.

{profiles, [
    {dev, [
        {erl_opts, [debug_info]},
        {relx, [
            {dev_mode, true},
            {include_erts, false}
        ]}
    ]},
    {prod, [
        {erl_opts, [
            {warnings_as_errors, false},
            warn_missing_spec,
            warn_unused_vars
        ]},
        {relx, [
            {dev_mode, false},
            {include_erts, true},
            {system_libs, false}
        ]}
    ]},
    {test, [
        {erl_opts, [debug_info, {warnings_as_errors, false}]},
        {deps, [
            {proper, "1.4.0"}
        ]}
    ]}
]}.

{relx, [
    {release, {tai_autonomics, "1.0.0"}, [
        kernel,
        stdlib,
        sasl,
        tai_autonomics
    ]},
    {sys_config, "config/sys.config"},
    {vm_args, "config/vm.args"},
    {overlay, [
        {mkdir, "log"}
    ]}
]}.

{plugins, [
    rebar3_format
]}.

{format, [
    {formatter, rebar3_format}
]}.

{dialyzer, [
    {warnings, [underspecs, overspecs, specdiffs]},
    {get_warnings, true}
]}.

{eunit_opts, [
    verbose
]}.

{ct_opts, [
    {sys_config, ["config/sys.config"]}
]}.

{overrides, [
    {override, jiffy, [
        {port_specs, []}
    ]}
]}.
