# TAIEA GCP Deployment Environment Configuration
# Copy to .env and update with your GCP project details
# DO NOT commit .env to version control

# ============================================================================
# GCP Project Configuration
# ============================================================================

# GCP Project ID (required)
# Format: lowercase letters, numbers, hyphens
# Get with: gcloud config get-value project
PROJECT_ID=taiea-phase1

# GCP Region (required)
# Valid options: us-central1, us-east1, us-west1, europe-west1, asia-northeast1
REGION=us-central1

# GCP Zone (optional, for regional resources)
ZONE=us-central1-a

# ============================================================================
# Docker & Container Registry Configuration
# ============================================================================

# Docker Registry (default: gcr.io for Container Registry)
# Alternatives: us-docker.pkg.dev, eu-docker.pkg.dev, asia-docker.pkg.dev
DOCKER_REGISTRY=gcr.io

# Docker image tag (for versioning)
# Examples: latest, v1.0.0, 2026-01-26, sha256:abc123...
IMAGE_TAG=latest

# Path to Dockerfile
DOCKERFILE_PATH=./tools/Dockerfile

# ============================================================================
# Cloud Run Service Configuration
# ============================================================================

# Cloud Run service name
SERVICE_NAME=taiea

# Environment for deployment (dev, staging, prod)
TAIEA_ENV=prod

# Container memory allocation
# Valid values: 128Mi, 256Mi, 512Mi, 1Gi, 2Gi, 4Gi, 8Gi
MEMORY_LIMIT=512Mi

# Container CPU allocation
# Valid values: 1, 2, 4 (CPU cores)
CPU_LIMIT=2

# Request timeout in seconds
# Valid values: 10-3600 seconds
TIMEOUT_SECONDS=300

# Maximum number of instances
# Auto-scaling max limit
MAX_INSTANCES=100

# Minimum number of instances
# Set to 0 for cost savings, 1+ for always-available
MIN_INSTANCES=0

# ============================================================================
# Erlang/OTP Configuration
# ============================================================================

# Erlang cookie for node communication
# Generate unique value: openssl rand -hex 32
ERLANG_COOKIE=taiea-secret-cookie

# Erlang VM memory (in MB)
ERL_MAX_PORTS=65536

# ============================================================================
# Application Configuration
# ============================================================================

# Log level (debug, info, warning, error, critical)
LOG_LEVEL=info

# Log format (text, json)
RUNNER_LOG_FORMAT=json

# Port for HTTP server
PORT=8080

# ============================================================================
# Database Configuration (Firestore)
# ============================================================================

# Firestore database ID (default: default)
FIRESTORE_DATABASE=default

# Firestore collections to use
# receipt_ledger: For storing receipt data
# signals: For autonomic signals
# entitlements: For entitlement cache
FIRESTORE_COLLECTIONS=receipts,signals,entitlements

# ============================================================================
# Pub/Sub Configuration
# ============================================================================

# Pub/Sub topic name for signals
PUBSUB_TOPIC=taiea-signals

# Pub/Sub subscription name
PUBSUB_SUBSCRIPTION=taiea-subscription

# Pub/Sub push endpoint path
PUBSUB_PUSH_ENDPOINT=/signals

# ============================================================================
# Monitoring & Observability
# ============================================================================

# OpenTelemetry export endpoint (optional)
# Leave empty to disable OTEL export
OTEL_EXPORTER_OTLP_ENDPOINT=

# Cloud Trace API (automatic if OTEL enabled)
ENABLE_CLOUD_TRACE=true

# Cloud Monitoring metrics (automatic)
ENABLE_CLOUD_MONITORING=true

# Cloud Logging (automatic)
ENABLE_CLOUD_LOGGING=true

# ============================================================================
# Security Configuration
# ============================================================================

# Service Account email for deployment
SERVICE_ACCOUNT=taiea-sa@${PROJECT_ID}.iam.gserviceaccount.com

# Allow unauthenticated invocations (false for production)
ALLOW_UNAUTHENTICATED=false

# ============================================================================
# Deployment Configuration
# ============================================================================

# GitHub Actions - Whether to deploy on push
DEPLOY_ON_PUSH=true

# GitHub Actions - Deploy to branch
DEPLOY_BRANCH=main

# GitHub Actions - Manual deployment trigger
ALLOW_MANUAL_DEPLOYMENT=true

# ============================================================================
# Billing & Cost Control
# ============================================================================

# Monthly budget threshold (in USD)
MONTHLY_BUDGET_LIMIT=500

# Alert email for budget threshold
BILLING_ALERT_EMAIL=ops@example.com

# ============================================================================
# Development/Testing Configuration
# ============================================================================

# Enable debug mode (verbose logging, extended timeouts)
DEBUG_MODE=false

# Dry run mode (simulate without actual GCP API calls)
DRY_RUN=false

# Verbose output for deployment scripts
VERBOSE=false

# ============================================================================
# Deployment Script Configuration
# ============================================================================

# Health check timeout (seconds)
HEALTH_CHECK_TIMEOUT=10

# Max health check retries
HEALTH_CHECK_MAX_RETRIES=3

# Health check retry delay (seconds)
HEALTH_CHECK_RETRY_DELAY=2

# Deployment verification enabled
VERIFY_DEPLOYMENT=true

# ============================================================================
# Notes
# ============================================================================

# Required for actual GCP deployment:
# 1. gcloud CLI installed and authenticated
# 2. Project created with billing enabled
# 3. Cloud Run, Container Registry, Pub/Sub, Firestore APIs enabled
# 4. Service account created with appropriate IAM roles
#
# To use this configuration:
# 1. Copy: cp .env.example .env
# 2. Edit: vim .env (add your project details)
# 3. Source: source .env
# 4. Deploy: ./tools/gcp-build-image.sh && ./tools/gcp-deploy.sh
#
# For security:
# - Never commit .env to version control
# - Use GCP Secret Manager for sensitive values
# - Rotate credentials regularly
# - Review IAM permissions quarterly
