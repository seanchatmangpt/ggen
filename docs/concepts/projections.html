<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Semantic Projections - ggen Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Language-agnostic generator for reproducible code projections">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ggen Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/seanchatmangpt/ggen" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/seanchatmangpt/ggen/edit/main/docs/src/src/concepts/projections.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#semantic-projections">Semantic Projections</a>
<ul>
<li><a href="#the-core-concept">The Core Concept</a></li>
<li><a href="#one-ontology-many-languages">One Ontology, Many Languages</a></li>
<li><a href="#type-mapping-semantic-to-language-specific">Type Mapping: Semantic to Language-Specific</a>
<ul>
<li><a href="#xsd-datatypes-to-language-types">XSD Datatypes to Language Types</a></li>
<li><a href="#example-product-price-across-languages">Example: Product Price Across Languages</a></li>
</ul>
</li>
<li><a href="#relationship-mapping-predicates-to-methods">Relationship Mapping: Predicates to Methods</a>
<ul>
<li><a href="#rdf-relationships">RDF Relationships</a></li>
<li><a href="#projected-to-code">Projected to Code</a></li>
</ul>
</li>
<li><a href="#complete-example-product-catalog-projections">Complete Example: Product Catalog Projections</a>
<ul>
<li><a href="#the-ontology-language-agnostic">The Ontology (Language-Agnostic)</a></li>
<li><a href="#projection-1-rust-struct">Projection 1: Rust Struct</a></li>
<li><a href="#projection-2-typescript-interface">Projection 2: TypeScript Interface</a></li>
<li><a href="#projection-3-python-dataclass">Projection 3: Python Dataclass</a></li>
<li><a href="#projection-4-sql-table-schema">Projection 4: SQL Table Schema</a></li>
<li><a href="#projection-5-graphql-type">Projection 5: GraphQL Type</a></li>
</ul>
</li>
<li><a href="#evolution-update-once-regenerate-everywhere">Evolution: Update Once, Regenerate Everywhere</a>
<ul>
<li><a href="#step-1-modify-the-ontology">Step 1: Modify the Ontology</a></li>
<li><a href="#step-2-regenerate-all-projections">Step 2: Regenerate All Projections</a></li>
<li><a href="#the-result">The Result</a></li>
</ul>
</li>
<li><a href="#how-projections-work-internally">How Projections Work Internally</a></li>
<li><a href="#projection-patterns-and-best-practices">Projection Patterns and Best Practices</a>
<ul>
<li><a href="#standard-pattern">Standard Pattern</a></li>
<li><a href="#marketplace-pattern">Marketplace Pattern</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1 id="semantic-projections"><a class="header" href="#semantic-projections">Semantic Projections</a></h1>
<h2 id="the-core-concept"><a class="header" href="#the-core-concept">The Core Concept</a></h2>
<p><strong>Semantic projections</strong> are the mechanism by which ggen transforms a single, language-agnostic RDF ontology into multiple language-specific code representations.</p>
<pre><code>                   RDF Ontology (Semantic Model)
                            ↓
        ┌───────────────────┼───────────────────┐
        ↓                   ↓                   ↓
   Rust Structs      TypeScript Types      Python Classes
</code></pre>
<p>The key insight: <strong>The domain model (ontology) is separate from its representation (projection).</strong></p>
<p>This separation enables:</p>
<ul>
<li><strong>Cross-language consistency</strong>: Same business logic across codebases</li>
<li><strong>Automatic synchronization</strong>: Change ontology → regenerate all projections</li>
<li><strong>Single source of truth</strong>: One model, many representations</li>
<li><strong>Evolution without drift</strong>: Update once, deploy everywhere</li>
</ul>
<h2 id="one-ontology-many-languages"><a class="header" href="#one-ontology-many-languages">One Ontology, Many Languages</a></h2>
<p>Traditional approach:</p>
<pre><code>Product.java     → Manually kept in sync with
Product.ts       → Each requires separate updates
Product.py       → Easy to drift out of sync
product.sql      → Different conventions, same entity
</code></pre>
<p><strong>ggen approach:</strong></p>
<pre><code class="language-turtle"># product_catalog.ttl (ONE source of truth)
pc:Product a rdfs:Class ;
    rdfs:label "Product" .

pc:name rdfs:domain pc:Product ; rdfs:range xsd:string .
pc:price rdfs:domain pc:Product ; rdfs:range xsd:decimal .
</code></pre>
<pre><code class="language-bash"># Generate all projections from one ontology
ggen gen rust/models.tmpl --graph product_catalog.ttl
ggen gen typescript/types.tmpl --graph product_catalog.ttl
ggen gen python/models.tmpl --graph product_catalog.ttl
ggen gen sql/schema.tmpl --graph product_catalog.ttl
</code></pre>
<p><strong>Result:</strong> Four language-specific implementations, guaranteed to be in sync.</p>
<h2 id="type-mapping-semantic-to-language-specific"><a class="header" href="#type-mapping-semantic-to-language-specific">Type Mapping: Semantic to Language-Specific</a></h2>
<p>ggen maps RDF datatypes (XSD schema types) to appropriate language-specific types.</p>
<h3 id="xsd-datatypes-to-language-types"><a class="header" href="#xsd-datatypes-to-language-types">XSD Datatypes to Language Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>XSD Type</th><th>Rust</th><th>TypeScript</th><th>Python</th><th>SQL</th></tr></thead><tbody>
<tr><td><code>xsd:string</code></td><td><code>String</code></td><td><code>string</code></td><td><code>str</code></td><td><code>VARCHAR</code></td></tr>
<tr><td><code>xsd:integer</code></td><td><code>i64</code></td><td><code>number</code></td><td><code>int</code></td><td><code>INTEGER</code></td></tr>
<tr><td><code>xsd:decimal</code></td><td><code>f64</code></td><td><code>number</code></td><td><code>float</code></td><td><code>DECIMAL</code></td></tr>
<tr><td><code>xsd:boolean</code></td><td><code>bool</code></td><td><code>boolean</code></td><td><code>bool</code></td><td><code>BOOLEAN</code></td></tr>
<tr><td><code>xsd:date</code></td><td><code>NaiveDate</code></td><td><code>Date</code></td><td><code>date</code></td><td><code>DATE</code></td></tr>
<tr><td><code>xsd:dateTime</code></td><td><code>DateTime</code></td><td><code>Date</code></td><td><code>datetime</code></td><td><code>TIMESTAMP</code></td></tr>
</tbody></table>
</div>
<p>These mappings are <strong>configurable</strong> via Handlebars helpers in templates.</p>
<h3 id="example-product-price-across-languages"><a class="header" href="#example-product-price-across-languages">Example: Product Price Across Languages</a></h3>
<p><strong>Ontology:</strong></p>
<pre><code class="language-turtle">pc:price a rdf:Property ;
    rdfs:domain pc:Product ;
    rdfs:range xsd:decimal ;
    rdfs:label "price" .
</code></pre>
<p><strong>Projected to:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>Field Declaration</th></tr></thead><tbody>
<tr><td>Rust</td><td><code>pub price: f64</code></td></tr>
<tr><td>TypeScript</td><td><code>price: number</code></td></tr>
<tr><td>Python</td><td><code>price: float</code></td></tr>
<tr><td>SQL</td><td><code>price DECIMAL(10, 2)</code></td></tr>
<tr><td>GraphQL</td><td><code>price: Float!</code></td></tr>
</tbody></table>
</div>
<p><strong>The ontology never changes.</strong> Only the projection templates differ.</p>
<h2 id="relationship-mapping-predicates-to-methods"><a class="header" href="#relationship-mapping-predicates-to-methods">Relationship Mapping: Predicates to Methods</a></h2>
<p>RDF relationships (object properties) project to different code patterns depending on the language.</p>
<h3 id="rdf-relationships"><a class="header" href="#rdf-relationships">RDF Relationships</a></h3>
<pre><code class="language-turtle"># Product belongs to a Category
pc:category a rdf:Property ;
    rdfs:domain pc:Product ;
    rdfs:range pc:Category ;
    rdfs:label "category" .

# Product has a Supplier
pc:supplier a rdf:Property ;
    rdfs:domain pc:Product ;
    rdfs:range pc:Supplier ;
    rdfs:label "supplier" .
</code></pre>
<h3 id="projected-to-code"><a class="header" href="#projected-to-code">Projected to Code</a></h3>
<p><strong>Rust:</strong></p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Product {
    pub name: String,
    pub price: f64,
    pub category: Category,  // Foreign key relationship
    pub supplier: Supplier,
}

impl Product {
    /// Get the category for this product
    pub fn get_category(&amp;self) -&gt; &amp;Category {
        &amp;self.category
    }

    /// Get the supplier for this product
    pub fn get_supplier(&amp;self) -&gt; &amp;Supplier {
        &amp;self.supplier
    }
}
<span class="boring">}</span></code></pre></pre>
<p><strong>TypeScript:</strong></p>
<pre><code class="language-typescript">interface Product {
  name: string;
  price: number;
  category: Category;
  supplier: Supplier;
}

class ProductService {
  async getCategory(product: Product): Promise&lt;Category&gt; {
    return product.category;
  }

  async getSupplier(product: Product): Promise&lt;Supplier&gt; {
    return product.supplier;
  }
}
</code></pre>
<p><strong>SQL:</strong></p>
<pre><code class="language-sql">CREATE TABLE products (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  price DECIMAL(10, 2) NOT NULL,
  category_id INTEGER REFERENCES categories(id),
  supplier_id INTEGER REFERENCES suppliers(id)
);
</code></pre>
<p><strong>Same relationship, different representations.</strong> The ontology defines the semantics, templates define the syntax.</p>
<h2 id="complete-example-product-catalog-projections"><a class="header" href="#complete-example-product-catalog-projections">Complete Example: Product Catalog Projections</a></h2>
<p>Let's see a full example of one ontology generating code in five languages.</p>
<h3 id="the-ontology-language-agnostic"><a class="header" href="#the-ontology-language-agnostic">The Ontology (Language-Agnostic)</a></h3>
<pre><code class="language-turtle">@prefix pc: &lt;http://example.org/product_catalog#&gt; .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; .

# Classes
pc:Product a rdfs:Class ;
    rdfs:label "Product" ;
    rdfs:comment "A product in the e-commerce catalog" .

pc:Category a rdfs:Class ;
    rdfs:label "Category" ;
    rdfs:comment "A product category" .

# Data properties (primitives)
pc:name rdfs:domain pc:Product ; rdfs:range xsd:string .
pc:price rdfs:domain pc:Product ; rdfs:range xsd:decimal .
pc:sku rdfs:domain pc:Product ; rdfs:range xsd:string .

# Object properties (relationships)
pc:category rdfs:domain pc:Product ; rdfs:range pc:Category .
</code></pre>
<h3 id="projection-1-rust-struct"><a class="header" href="#projection-1-rust-struct">Projection 1: Rust Struct</a></h3>
<p><strong>Template:</strong> <code>rust/models.tmpl</code></p>
<pre><code class="language-handlebars">#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Product {
{{#each properties}}
    pub {{ name }}: {{ rust_type datatype }},
{{/each}}
}
</code></pre>
<p><strong>Generated:</strong> <code>src/models/product.rs</code></p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Product {
    pub name: String,
    pub price: f64,
    pub sku: String,
    pub category: Category,
}
<span class="boring">}</span></code></pre></pre>
<h3 id="projection-2-typescript-interface"><a class="header" href="#projection-2-typescript-interface">Projection 2: TypeScript Interface</a></h3>
<p><strong>Template:</strong> <code>typescript/types.tmpl</code></p>
<pre><code class="language-handlebars">export interface Product {
{{#each properties}}
  {{ name }}: {{ ts_type datatype }};
{{/each}}
}
</code></pre>
<p><strong>Generated:</strong> <code>src/types/Product.ts</code></p>
<pre><code class="language-typescript">export interface Product {
  name: string;
  price: number;
  sku: string;
  category: Category;
}
</code></pre>
<h3 id="projection-3-python-dataclass"><a class="header" href="#projection-3-python-dataclass">Projection 3: Python Dataclass</a></h3>
<p><strong>Template:</strong> <code>python/models.tmpl</code></p>
<pre><code class="language-handlebars">@dataclass
class Product:
{{#each properties}}
    {{ name }}: {{ python_type datatype }}
{{/each}}
</code></pre>
<p><strong>Generated:</strong> <code>models/product.py</code></p>
<pre><code class="language-python">from dataclasses import dataclass

@dataclass
class Product:
    name: str
    price: float
    sku: str
    category: Category
</code></pre>
<h3 id="projection-4-sql-table-schema"><a class="header" href="#projection-4-sql-table-schema">Projection 4: SQL Table Schema</a></h3>
<p><strong>Template:</strong> <code>sql/schema.tmpl</code></p>
<pre><code class="language-handlebars">CREATE TABLE products (
  id SERIAL PRIMARY KEY,
{{#each properties}}
  {{ name }} {{ sql_type datatype }}{{#if required}} NOT NULL{{/if}},
{{/each}}
);
</code></pre>
<p><strong>Generated:</strong> <code>migrations/001_create_products.sql</code></p>
<pre><code class="language-sql">CREATE TABLE products (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  price DECIMAL(10, 2) NOT NULL,
  sku VARCHAR(50) NOT NULL,
  category_id INTEGER REFERENCES categories(id)
);
</code></pre>
<h3 id="projection-5-graphql-type"><a class="header" href="#projection-5-graphql-type">Projection 5: GraphQL Type</a></h3>
<p><strong>Template:</strong> <code>graphql/schema.tmpl</code></p>
<pre><code class="language-handlebars">type Product {
{{#each properties}}
  {{ name }}: {{ graphql_type datatype }}!
{{/each}}
}
</code></pre>
<p><strong>Generated:</strong> <code>schema/product.graphql</code></p>
<pre><code class="language-graphql">type Product {
  name: String!
  price: Float!
  sku: String!
  category: Category!
}
</code></pre>
<p><strong>Five languages, one source of truth, complete consistency.</strong></p>
<h2 id="evolution-update-once-regenerate-everywhere"><a class="header" href="#evolution-update-once-regenerate-everywhere">Evolution: Update Once, Regenerate Everywhere</a></h2>
<p>The real power of semantic projections emerges when evolving your domain model.</p>
<h3 id="step-1-modify-the-ontology"><a class="header" href="#step-1-modify-the-ontology">Step 1: Modify the Ontology</a></h3>
<p>Add a <code>rating</code> field to Product:</p>
<pre><code class="language-turtle"># Add to product_catalog.ttl
pc:rating a rdf:Property ;
    rdfs:domain pc:Product ;
    rdfs:range xsd:decimal ;
    rdfs:label "rating" ;
    rdfs:comment "Product rating from 0.0 to 5.0" .
</code></pre>
<h3 id="step-2-regenerate-all-projections"><a class="header" href="#step-2-regenerate-all-projections">Step 2: Regenerate All Projections</a></h3>
<pre><code class="language-bash"># One command per projection
ggen gen rust/models.tmpl --graph product_catalog.ttl
ggen gen typescript/types.tmpl --graph product_catalog.ttl
ggen gen python/models.tmpl --graph product_catalog.ttl
ggen gen sql/schema.tmpl --graph product_catalog.ttl
ggen gen graphql/schema.tmpl --graph product_catalog.ttl
</code></pre>
<p>Or batch with a script:</p>
<pre><code class="language-bash"># regenerate-all.sh
for template in templates/*.tmpl; do
  ggen gen "$template" --graph product_catalog.ttl
done
</code></pre>
<h3 id="the-result"><a class="header" href="#the-result">The Result</a></h3>
<p><strong>All five languages now have the <code>rating</code> field:</strong></p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Rust
pub struct Product {
    pub name: String,
    pub price: f64,
    pub sku: String,
    pub rating: f64,  // ← NEW
    pub category: Category,
}
<span class="boring">}</span></code></pre></pre>
<pre><code class="language-typescript">// TypeScript
export interface Product {
  name: string;
  price: number;
  sku: string;
  rating: number;  // ← NEW
  category: Category;
}
</code></pre>
<pre><code class="language-python"># Python
@dataclass
class Product:
    name: str
    price: float
    sku: str
    rating: float  # ← NEW
    category: Category
</code></pre>
<pre><code class="language-sql">-- SQL
CREATE TABLE products (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  price DECIMAL(10, 2) NOT NULL,
  sku VARCHAR(50) NOT NULL,
  rating DECIMAL(2, 1),  -- NEW
  category_id INTEGER REFERENCES categories(id)
);
</code></pre>
<pre><code class="language-graphql"># GraphQL
type Product {
  name: String!
  price: Float!
  sku: String!
  rating: Float!  # ← NEW
  category: Category!
}
</code></pre>
<p><strong>No manual editing. No copy-paste. No drift. Guaranteed synchronization.</strong></p>
<h2 id="how-projections-work-internally"><a class="header" href="#how-projections-work-internally">How Projections Work Internally</a></h2>
<p>Under the hood, ggen performs these steps for each projection:</p>
<ol>
<li><strong>Load ontology</strong> into Oxigraph RDF store</li>
<li><strong>Execute SPARQL query</strong> defined in template frontmatter</li>
<li><strong>Extract variables</strong> from query results</li>
<li><strong>Map types</strong> using Handlebars helpers (e.g., <code>{{ rust_type }}</code>)</li>
<li><strong>Render template</strong> with mapped variables</li>
<li><strong>Write output</strong> to specified file path</li>
</ol>
<p><strong>Example template with SPARQL query:</strong></p>
<pre><code class="language-yaml">---
to: src/models/{{ class_name }}.rs
vars:
  class_name: Product
sparql: |
  PREFIX pc: &lt;http://example.org/product_catalog#&gt;
  PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;

  SELECT ?property ?datatype ?label WHERE {
    ?property rdfs:domain pc:Product .
    ?property rdfs:range ?datatype .
    ?property rdfs:label ?label .
  }
  ORDER BY ?label
---
pub struct {{ class_name }} {
{{#each sparql_results}}
    pub {{ ?label }}: {{ rust_type ?datatype }},
{{/each}}
}
</code></pre>
<p><strong>The SPARQL query extracts data from the ontology.</strong> The template renders it as Rust code.</p>
<h2 id="projection-patterns-and-best-practices"><a class="header" href="#projection-patterns-and-best-practices">Projection Patterns and Best Practices</a></h2>
<h3 id="standard-pattern"><a class="header" href="#standard-pattern">Standard Pattern</a></h3>
<ol>
<li><strong>Define ontology</strong> in language-agnostic RDF</li>
<li><strong>Create templates</strong> for each target language</li>
<li><strong>Use SPARQL</strong> to extract exactly what each template needs</li>
<li><strong>Map types</strong> with Handlebars helpers</li>
<li><strong>Regenerate</strong> whenever ontology changes</li>
</ol>
<h3 id="marketplace-pattern"><a class="header" href="#marketplace-pattern">Marketplace Pattern</a></h3>
<p>For reusable projections, ggen supports the <strong>marketplace gpack</strong> pattern:</p>
<pre><code class="language-bash"># Install projection templates from marketplace
ggen add io.ggen.rust.models
ggen add io.ggen.typescript.types
ggen add io.ggen.sql.schema

# Generate from marketplace templates
ggen gen io.ggen.rust.models:models.tmpl --graph product_catalog.ttl
ggen gen io.ggen.typescript.types:types.tmpl --graph product_catalog.ttl
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Pre-built, tested templates</li>
<li>Consistent code style across projects</li>
<li>Community-maintained type mappings</li>
<li>Version-locked for determinism</li>
</ul>
<h3 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h3>
<p><strong>1. Use semantic types in ontology:</strong></p>
<pre><code class="language-turtle"># Good: Semantic precision
pc:createdAt rdfs:range xsd:dateTime .
pc:isActive rdfs:range xsd:boolean .

# Avoid: Generic types lose information
pc:createdAt rdfs:range xsd:string .  # ❌ Lost temporal semantics
</code></pre>
<p><strong>2. Leverage SPARQL for complex queries:</strong></p>
<pre><code class="language-sparql"># Extract only required properties (not optional)
SELECT ?property ?datatype WHERE {
    ?property rdfs:domain ?class .
    ?property rdfs:range ?datatype .
    FILTER EXISTS { ?shape sh:property [ sh:path ?property ; sh:minCount 1 ] }
}
</code></pre>
<p><strong>3. Create custom type mappings:</strong></p>
<pre><code class="language-handlebars">{{! Custom helper for domain-specific types }}
{{ custom_type datatype }}

{{! Where custom_type might map: }}
{{! xsd:string + pc:UUID → Uuid (Rust) or uuid.UUID (Python) }}
</code></pre>
<p><strong>4. Document projection conventions:</strong></p>
<pre><code class="language-markdown"># Type Mapping Conventions

| Ontology Type | Rust Type | Notes |
|--------------|----------|-------|
| xsd:decimal + pc:Price | Decimal | Use rust_decimal crate for precision |
| xsd:string + pc:Email | String | Add validation in constructor |
</code></pre>
<p><strong>5. Automate regeneration in CI:</strong></p>
<pre><code class="language-yaml"># .github/workflows/codegen.yml
- name: Regenerate projections
  run: |
    ./scripts/regenerate-all.sh
    git diff --exit-code || echo "::error::Projections out of sync"
</code></pre>
<p>This ensures ontology changes are caught before merging.</p>
<hr />
<p><strong>Semantic projections are the bridge between abstract domain models and concrete implementations.</strong> By separating semantics from syntax, ggen enables true cross-language consistency and effortless evolution.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../concepts/rdf-shacl-sparql.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../concepts/determinism.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../concepts/rdf-shacl-sparql.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../concepts/determinism.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
