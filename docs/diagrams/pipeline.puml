@startuml
title rgen pipeline
start
:load templates, graphs, shapes;
:SHACL validate;
if (sparql.vars?) then (yes)
  :bind vars;
endif
if (sparql.matrix?) then (yes)
  :run matrix SELECT (ORDER BY);
  :for each row render -> artifact;
else (no)
  :render single -> artifact;
endif
:compute manifest key K;
if (K changed?) then (yes)
  :write files;
else (no)
  :skip;
endif
stop
@enduml
