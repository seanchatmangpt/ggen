# ggen v2.1.0 Orchestration Workflow Plan

**Orchestrator**: Task Orchestrator Agent
**Date**: 2025-11-02
**Status**: IN PROGRESS
**Methodology**: 4-Phase Sequential/Parallel Execution

---

## Objective

Complete v2.1.0 development to remove deprecated `cli/src/commands/` directory and implement auto-discovery of CLI commands from `cli/src/cmds/` structure per deprecation plan.

---

## Workflow Phases

### Phase 1: Analysis & Design (PARALLEL)
**Duration**: 15-20 minutes
**Agents**: 2 agents running concurrently

#### Agent 1: code-analyzer
**Task**: Analyze current integration points
- Map all files in `cli/src/commands/` to be removed
- Identify dependencies on old command structure
- Analyze current `cli/src/cmds/` structure
- Document integration points with domain layer
- Create comprehensive migration checklist

**Deliverable**: `/docs/orchestration/v2.1.0-integration-analysis.md`

#### Agent 2: system-architect
**Task**: Design CLI auto-discovery system
- Design template-based command discovery from `cli/src/cmds/`
- Create architecture for dynamic command registration
- Design backward compatibility layer (if needed)
- Specify testing strategy
- Create implementation specification

**Deliverable**: `/docs/orchestration/v2.1.0-architecture-design.md`

**Dependencies**: None (truly parallel)
**Blocker Handling**: Agents coordinate via hooks and memory

---

### Phase 2: Implementation (SEQUENTIAL after Phase 1)
**Duration**: 30-40 minutes
**Agents**: 1 agent (backend-dev)

#### Agent: backend-dev
**Task**: Implement CLI auto-discovery system
- Read Phase 1 deliverables from docs/orchestration/
- Implement command auto-discovery from `cli/src/cmds/`
- Remove `cli/src/commands/` directory entirely
- Update `cli/src/lib.rs` and entry points
- Handle compilation errors
- Update imports across codebase

**Deliverable**: Working CLI with auto-discovery

**Dependencies**: BLOCKED on Phase 1 completion
**Input**: Analysis + architecture from Phase 1
**Blocker Handling**:
- If build fails → run `cargo clean`
- If missing types → reference Phase 1 analysis
- If tests fail → document for Phase 3

---

### Phase 3: Validation (PARALLEL after Phase 2)
**Duration**: 20-30 minutes
**Agents**: 2 agents running concurrently

#### Agent 1: tester
**Task**: Comprehensive integration testing
- Run `cargo test` (all tests must pass)
- Create integration tests for auto-discovery
- Validate all 13 commands still work
- Performance regression tests
- Document test results

**Deliverable**: `/tests/integration/v2.1.0_autodiscovery.rs` + test report

#### Agent 2: production-validator
**Task**: Release readiness validation
- Run `cargo build --release` (must succeed)
- Validate binary size (SLO: <30MB)
- Run `ggen help` (all commands present)
- Run `ggen doctor` (health check)
- End-to-end workflow validation
- Security audit
- Performance benchmarks

**Deliverable**: `/.claude/refactor-v2/V2.1.0-PRODUCTION-VALIDATION.md`

**Dependencies**: BLOCKED on Phase 2 completion
**Blocker Handling**:
- If tests fail → coordinate with tester to fix
- If build fails → escalate to orchestrator
- If SLOs missed → document and decide go/no-go

---

### Phase 4: Release Preparation (SEQUENTIAL after Phase 3)
**Duration**: 10-15 minutes
**Agent**: Orchestrator (this agent)

#### Tasks:
1. Aggregate all deliverables from Phases 1-3
2. Create comprehensive release notes
3. Update CHANGELOG.md with v2.1.0 entry
4. Create git tag v2.1.0
5. Generate final orchestration report
6. Execute post-task hooks

**Deliverables**:
- `/.claude/refactor-v2/V2.1.0-RELEASE-NOTES.md`
- `/CHANGELOG.md` (updated)
- Git tag: v2.1.0
- `/.claude/refactor-v2/V2.1.0-ORCHESTRATION-REPORT.md`

**Dependencies**: BLOCKED on Phase 3 completion (all tests passing + production validation)

---

## Coordination Protocol

### All Agents MUST:

**Before Starting:**
```bash
npx claude-flow@alpha hooks pre-task --description "v2.1.0 [agent-role]: [task]"
npx claude-flow@alpha hooks session-restore --session-id "swarm-v2.1.0"
```

**During Work:**
```bash
npx claude-flow@alpha hooks post-edit --file "[file]" --memory-key "swarm/v2.1.0/[agent]/[step]"
npx claude-flow@alpha hooks notify --message "[agent]: [what was done]"
```

**After Completion:**
```bash
npx claude-flow@alpha hooks post-task --task-id "task-v2.1.0-[agent]"
npx claude-flow@alpha hooks session-end --export-metrics true
```

---

## Success Criteria

### Phase 1 Success:
- [ ] Integration analysis complete with file mapping
- [ ] Architecture design with auto-discovery specification
- [ ] Both deliverables saved to docs/orchestration/

### Phase 2 Success:
- [ ] `cli/src/commands/` directory removed
- [ ] Auto-discovery implemented in `cli/src/lib.rs`
- [ ] `cargo build --release` succeeds (0 errors)
- [ ] All commands discoverable via `ggen help`

### Phase 3 Success:
- [ ] `cargo test` passes (>95% success rate)
- [ ] Integration tests validate auto-discovery
- [ ] Production validation: GO decision
- [ ] All SLOs met (binary size, performance, security)

### Phase 4 Success:
- [ ] Release notes comprehensive and accurate
- [ ] CHANGELOG updated
- [ ] Git tag v2.1.0 created
- [ ] Orchestration report complete

---

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Circular dependency during removal | Medium | High | Code analyzer maps dependencies first |
| Tests fail after removal | High | Medium | Tester creates new integration tests |
| Auto-discovery breaks existing workflows | Low | High | Production validator validates end-to-end |
| Build failures | Medium | High | Backend-dev runs cargo clean if needed |

---

## Timeline Estimate

| Phase | Duration | Cumulative |
|-------|----------|------------|
| Phase 1 | 15-20 min | 20 min |
| Phase 2 | 30-40 min | 60 min |
| Phase 3 | 20-30 min | 90 min |
| Phase 4 | 10-15 min | 105 min |

**Total**: 1.75 hours (105 minutes)

---

**Workflow Status**: Starting Phase 1
**Next Action**: Spawn code-analyzer and system-architect agents in parallel
