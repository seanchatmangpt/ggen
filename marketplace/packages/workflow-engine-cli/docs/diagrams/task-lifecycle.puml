@startuml task-lifecycle
!theme plain

title BPMN Task State Machine

[*] --> Created : Task defined in workflow

Created --> Pending : Process instance started

Pending --> Assigned : assign verb\nUser/system assigned

Assigned --> InProgress : Task started

InProgress --> Completed : complete verb\nSuccessful completion
InProgress --> Failed : Error occurred\nException thrown
InProgress --> Suspended : pause verb\nManual suspension

Suspended --> InProgress : resume verb\nResume execution
Suspended --> Cancelled : abort verb\nProcess aborted

Failed --> Retrying : retry verb\nRetry attempt
Retrying --> InProgress : Retry initiated
Retrying --> Failed : Max retries exceeded

Assigned --> Delegated : delegate verb\nReassigned to another user
Delegated --> Assigned : New assignee accepts

Assigned --> Escalated : escalate verb\nOverdue or blocked
Escalated --> Assigned : Manager assigns

Completed --> [*]
Cancelled --> [*]
Failed --> [*] : After max retries

note right of Created
  Initial state when
  task is defined in
  BPMN workflow
end note

note right of Pending
  Waiting for:
  - Assignment
  - Required data
  - Dependencies
end note

note right of Assigned
  Task assigned to:
  - Specific user
  - User group
  - Service endpoint
end note

note right of InProgress
  Task is being executed:
  - User task: User working
  - Service task: API call
  - Script task: Script running
end note

note right of Failed
  Failure reasons:
  - Service unavailable
  - Validation error
  - Timeout exceeded
  - Business rule violation
end note

note right of Retrying
  Retry strategies:
  - Immediate
  - Exponential backoff
  - Fixed delay
  - Custom policy
end note

note bottom of Delegated
  Delegation scenarios:
  - Lack of expertise
  - Workload balancing
  - Absence coverage
end note

note bottom of Escalated
  Escalation triggers:
  - Due date exceeded
  - SLA breach
  - Manual escalation
  - Priority change
end note

@enduml
