---
to: lib/tests/unit.test.ts
description: Vitest unit tests for Zod schemas
vars:
  entityName: string
  propName: string
metadata:
  category: testing
  framework: vitest
---
{# =============================================================================
   UNIT TESTS - Generated from RDF ontology
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
/**
 * @fileoverview Vitest unit tests for Zod schemas
 * DO NOT EDIT - auto-generated by ggen sync
 */

import { describe, it, expect } from "vitest";
import * as schemas from "@/schemas";

{%- set current_entity = "" -%}
{%- for row in sparql_results -%}
{%- set entityName = row["?entityName"] | default(value="") -%}
{%- set propName = row["?propName"] | default(value="") -%}
{%- set propType = row["?propType"] | default(value="string") -%}
{%- set required = row["?required"] | default(value="false") -%}
{%- set format = row["?format"] | default(value="") -%}

{%- if entityName != current_entity -%}
{%- if current_entity != "" %}
  });
});

{% endif -%}
{%- set_global current_entity = entityName %}
describe("{{ entityName }} Schema", () => {
  describe("validation", () => {
    it("should validate valid {{ entityName | lower }} data", () => {
      // Arrange: Create valid test data
      const validData = {
        id: "test-id-123",
        createdAt: new Date().toISOString(),
{%- endif %}
        {{ propName }}: {% if propType == "string" %}"test-value"{% elif propType == "integer" %}42{% elif propType == "boolean" %}true{% elif propType == "datetime" %}new Date().toISOString(){% elif propType == "enum" %}"todo"{% else %}"test"{% endif %},
{%- endfor %}
      };

      // Act: Parse with schema
      const result = schemas.{{ current_entity | lower }}Schema.safeParse(validData);

      // Assert: Should succeed
      expect(result.success).toBe(true);
    });

    it("should reject invalid {{ current_entity | lower }} data", () => {
      // Arrange: Create invalid data
      const invalidData = {};

      // Act: Parse with schema
      const result = schemas.{{ current_entity | lower }}Schema.safeParse(invalidData);

      // Assert: Should fail
      expect(result.success).toBe(false);
    });
  });

  describe("create schema", () => {
    it("should omit id and createdAt", () => {
      // Arrange: Data without id/createdAt
      const createData = {
        name: "Test",
      };

      // Act: Parse with create schema
      const result = schemas.create{{ current_entity }}Schema.safeParse(createData);

      // Assert: Check shape
      expect(result.success).toBeDefined();
    });
  });
});
