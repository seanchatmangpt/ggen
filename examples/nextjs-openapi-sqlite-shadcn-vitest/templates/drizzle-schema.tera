---
to: lib/db/schema.ts
description: Generates Drizzle ORM schema for SQLite
vars:
  entityName: string
  propName: string
  propType: string
metadata:
  category: database
  output_type: schema
---
{# =============================================================================
   DRIZZLE ORM SCHEMA - Generated from RDF ontology
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
/**
 * @fileoverview Drizzle ORM schema for SQLite
 * DO NOT EDIT - auto-generated by ggen sync
 */

import { sqliteTable, text, integer } from "drizzle-orm/sqlite-core";

{%- set current_entity = "" -%}
{%- for row in sparql_results -%}
{%- set entityName = row["?entityName"] | default(value="") -%}
{%- set propName = row["?propName"] | default(value="") -%}
{%- set propType = row["?propType"] | default(value="string") -%}
{%- set required = row["?required"] | default(value="false") -%}
{%- set isPrimaryKey = row["?isPrimaryKey"] | default(value="false") -%}
{%- set isUnique = row["?isUnique"] | default(value="false") -%}
{%- set references = row["?references"] | default(value="") -%}

{%- if entityName != current_entity -%}
{%- if current_entity != "" %}
});

/** Select type for {{ current_entity | lower }} table */
export type {{ current_entity }} = typeof {{ current_entity | lower }}Table.$inferSelect;

/** Insert type for {{ current_entity | lower }} table */
export type New{{ current_entity }} = typeof {{ current_entity | lower }}Table.$inferInsert;

{% endif -%}
{%- set_global current_entity = entityName %}
/**
 * {{ entityName }} table
 */
export const {{ entityName | lower }}Table = sqliteTable("{{ entityName | lower }}", {
{%- endif %}
  {{ propName }}: {% if propType == "string" or propType == "enum" -%}
text("{{ propName }}")
  {%- elif propType == "integer" -%}
integer("{{ propName }}")
  {%- elif propType == "datetime" -%}
text("{{ propName }}")
  {%- elif propType == "boolean" -%}
integer("{{ propName }}", { mode: "boolean" })
  {%- else -%}
text("{{ propName }}")
  {%- endif -%}
{% if isPrimaryKey == "true" %}.primaryKey(){% endif %}{% if required == "true" %}.notNull(){% endif %}{% if isUnique == "true" %}.unique(){% endif %}{% if references != "" %}.references(() => {{ references | lower }}Table.id){% endif %},
{%- endfor %}
});

/** Select type for {{ current_entity | lower }} table */
export type {{ current_entity }} = typeof {{ current_entity | lower }}Table.$inferSelect;

/** Insert type for {{ current_entity | lower }} table */
export type New{{ current_entity }} = typeof {{ current_entity | lower }}Table.$inferInsert;
