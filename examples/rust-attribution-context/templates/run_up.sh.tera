#!/usr/bin/env bash
# Generated World Closure: UP - DO NOT EDIT
#
# This file is automatically generated by ggen from ontology/
# To make changes, edit the ontology and run: ggen sync

set -euo pipefail

PROJECT_NAME="{{ sparql_results[0]["?contextName"] | default(value="attribution") }}"
SERVICE_PORT="{{ sparql_results[0]["?servicePort"] | default(value="8080") }}"

echo "ðŸ­ TCPS: Booting {{ sparql_results[0]["?contextName"] | default(value="Attribution") }} World"

# Build the world (generated code)
echo "ðŸ“¦ Building world..."
cd "$(dirname "$0")/.."
cargo build --release --manifest-path world/Cargo.toml

# Start the service
echo "ðŸš€ Starting service on port ${SERVICE_PORT}..."
RUST_LOG=info cargo run --release --manifest-path world/Cargo.toml &
SERVICE_PID=$!

# Save PID for shutdown
echo $SERVICE_PID > /tmp/${PROJECT_NAME}.pid

echo "âœ… World is up! PID: ${SERVICE_PID}"
echo "ðŸ“¡ Service: http://localhost:${SERVICE_PORT}"
echo ""
echo "Run './world/run/status' to check health"
echo "Run './world/run/down' to shutdown"
