//! Generated Command Handlers - DO NOT EDIT
//!
//! This file is automatically generated by ggen from ontology/commands.ttl
//! To make changes, edit the ontology and run: ggen sync

use crate::commands::*;
use crate::events::*;
use crate::aggregates::*;
use uuid::Uuid;

pub type Result<T> = std::result::Result<T, HandlerError>;

#[derive(Debug, thiserror::Error)]
pub enum HandlerError {
    #[error("Validation failed: {0}")]
    Validation(String),
    #[error("Not found: {0}")]
    NotFound(String),
    #[error("Business rule violated: {0}")]
    BusinessRule(String),
}

{% for row in sparql_results -%}
{%- set command_name = row["?commandName"] -%}
{%- set aggregate_name = row["?aggregateName"] -%}
{%- set event_name = row["?eventName"] -%}

/// Handle {{ command_name }} command
pub fn handle_{{ command_name | lower }}(
    aggregate: &mut {{ aggregate_name }},
    command: {{ command_name }},
) -> Result<{{ event_name }}> {
    // TODO: Business logic validation
    // This is where domain invariants are enforced

    // Emit event
    Ok({{ event_name }} {
        // Map command fields to event fields
        ..Default::default()
    })
}

{% endfor %}
