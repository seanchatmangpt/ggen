---
to: output/feature-specs.mjs
description: Detailed feature specifications for top opportunities
metadata:
  category: jtbd
  output_type: specifications
---
/**
 * @fileoverview JTBD Feature Specifications
 * Generated from opportunities with score >= 14 (critical/high priority)
 * DO NOT EDIT - auto-generated by ggen sync
 * @module jtbd/feature-specs
 */

/**
 * @typedef {Object} FeatureSpec
 * @property {string} id
 * @property {string} title
 * @property {string} avatar
 * @property {string} avatarDescription
 * @property {string} job
 * @property {string} jobStep
 * @property {string} problem
 * @property {string} currentState
 * @property {number} importance
 * @property {number} satisfaction
 * @property {number} opportunityScore
 * @property {string[]} outcomeStatements
 * @property {string[]} suggestedCapabilities
 */

/**
 * Feature specifications for high-priority opportunities
 * @type {FeatureSpec[]}
 */
export const featureSpecs = [
{%- set spec_id = 0 -%}
{%- for row in sparql_results %}
{%- set spec_id = spec_id + 1 %}
  {
    id: "FEAT-{{ "%03d" | format(num=spec_id) }}",
    title: "{{ row["?stepDescription"] }}",
    avatar: "{{ row["?avatarName"] }}",
    avatarDescription: "{{ row["?avatarDescription"] }}",
    job: "{{ row["?jobName"] }}",
    jobStep: "{{ row["?stepType"] }}",
    problem: "{{ row["?painPoint"] }}",
    currentState: "{{ row["?currentSolution"] }}",
    importance: {{ row["?importance"] }},
    satisfaction: {{ row["?satisfaction"] }},
    opportunityScore: {{ row["?opportunityScore"] }},
    outcomeStatements: [
      "Minimize time spent {{ row["?stepDescription"] | lower }}",
      "Minimize errors when {{ row["?stepDescription"] | lower }}",
      "Minimize frustration caused by {{ row["?painPoint"] | lower }}",
    ],
    suggestedCapabilities: [
      "Automate {{ row["?currentSolution"] | lower }}",
      "Provide guardrails to prevent {{ row["?painPoint"] | lower }}",
      "Enable self-service for {{ row["?stepDescription"] | lower }}",
    ],
  },
{%- endfor %}
];

/**
 * Get feature spec by ID
 * @param {string} id
 * @returns {FeatureSpec | undefined}
 */
export function getSpec(id) {
  return featureSpecs.find(s => s.id === id);
}

/**
 * Get specs by avatar
 * @param {string} avatarName
 * @returns {FeatureSpec[]}
 */
export function getSpecsByAvatar(avatarName) {
  return featureSpecs.filter(s => s.avatar === avatarName);
}

/**
 * Get specs by job step type
 * @param {string} stepType
 * @returns {FeatureSpec[]}
 */
export function getSpecsByStep(stepType) {
  return featureSpecs.filter(s => s.jobStep === stepType);
}

/**
 * Calculate total addressable opportunity
 * @returns {number}
 */
export function getTotalOpportunity() {
  return featureSpecs.reduce((sum, s) => sum + s.opportunityScore, 0);
}

/**
 * Export to PRD format
 * @returns {string}
 */
export function toPRD() {
  return `# Product Requirements Document

## Executive Summary
This document specifies ${featureSpecs.length} high-priority features identified through JTBD analysis.
Total Opportunity Score: ${getTotalOpportunity()}

## Features

${featureSpecs.map(s => `
### ${s.id}: ${s.title}

**Target User:** ${s.avatar}
> ${s.avatarDescription}

**Job to be Done:** ${s.job}

**Job Step:** ${s.jobStep}

**Current State:** ${s.currentState}

**Problem:** ${s.problem}

**Opportunity Score:** ${s.opportunityScore} (Importance: ${s.importance}, Satisfaction: ${s.satisfaction})

#### Desired Outcomes
${s.outcomeStatements.map(o => `- ${o}`).join('\n')}

#### Suggested Capabilities
${s.suggestedCapabilities.map(c => `- ${c}`).join('\n')}

---
`).join('\n')}
`;
}

// Summary
export const stats = {
  totalSpecs: featureSpecs.length,
  totalOpportunity: getTotalOpportunity(),
  avgOpportunityScore: featureSpecs.reduce((sum, s) => sum + s.opportunityScore, 0) / featureSpecs.length,
  byJobStep: featureSpecs.reduce((acc, s) => {
    acc[s.jobStep] = (acc[s.jobStep] || 0) + 1;
    return acc;
  }, {}),
};
