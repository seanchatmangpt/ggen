//! Generated Aggregates - DO NOT EDIT
//!
//! This file is automatically generated by ggen from ontology/entities.ttl
//! To make changes, edit the ontology and run: ggen sync

use chrono::{DateTime, Utc};
use rust_decimal::Decimal;
use serde::{Deserialize, Serialize};
use uuid::Uuid;

{% set current_aggregate = "" -%}
{% for row in sparql_results -%}
  {%- set aggregate_name = row["?aggregateName"] -%}

  {%- if aggregate_name != current_aggregate -%}
    {%- if current_aggregate != "" %}
}

impl {{ current_aggregate }} {
    /// Create new aggregate instance
    pub fn new(id: Uuid) -> Self {
        Self {
            id,
            ..Default::default()
        }
    }
}
    {% endif -%}

/// {{ row["?aggregateComment"] | default(value=aggregate_name) }}
#[derive(Debug, Clone, Serialize, Deserialize, PartialEq)]
pub struct {{ aggregate_name }} {
    {%- set current_aggregate = aggregate_name -%}
  {%- endif -%}

  {%- if row["?fieldName"] -%}
  {%- set rust_type = row["?fieldType"] -%}
  {%- set required = row["?fieldRequired"] | default(value="false") -%}

    pub {{ row["?fieldName"] }}: {%- if required == "false" %}Option<{%- endif %}{{ rust_type }}{%- if required == "false" %}>{%- endif %},
  {%- endif -%}
{%- endfor %}
}

impl {{ current_aggregate }} {
    /// Create new aggregate instance
    pub fn new(id: Uuid) -> Self {
        Self {
            id,
            ..Default::default()
        }
    }
}

impl Default for {{ current_aggregate }} {
    fn default() -> Self {
        Self {
{%- for row in sparql_results -%}
  {%- if row["?aggregateName"] == current_aggregate and row["?fieldName"] %}
            {{ row["?fieldName"] }}: Default::default(),
  {%- endif -%}
{%- endfor %}
        }
    }
}
