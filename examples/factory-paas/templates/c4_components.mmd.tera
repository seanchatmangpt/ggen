%%{init: {'theme':'base'}}%%
graph LR
    %% Generated C4 Component Diagram - DO NOT EDIT
    %% This file is automatically generated by ggen from ontology/
    %% To make changes, edit the ontology and run: ggen sync

    classDef command fill:#4ecdc4,stroke:#3ba39c,color:#000000
    classDef handler fill:#1168bd,stroke:#0b4884,color:#ffffff
    classDef event fill:#ff6b6b,stroke:#cc5555,color:#ffffff
    classDef policy fill:#ffe66d,stroke:#ccb856,color:#000000

    subgraph "Command Flow"
{% for row in sparql_results -%}
{%- if row["?commandName"] %}
        Cmd_{{ row["?commandName"] }}["{{ row["?commandName"] }}
        ---
        Command"]:::command

        Handler_{{ row["?commandName"] }}["{{ row["?handlerName"] }}
        ---
        Command Handler"]:::handler

        Cmd_{{ row["?commandName"] }} -->|"Handled by"| Handler_{{ row["?commandName"] }}

  {%- if row["?eventName"] %}
        Event_{{ row["?eventName"] }}["{{ row["?eventName"] }}
        ---
        Domain Event"]:::event

        Handler_{{ row["?commandName"] }} -->|"Emits"| Event_{{ row["?eventName"] }}
  {% endif -%}
{% endif -%}
{%- endfor %}
    end

    subgraph "Policies"
{% for row in sparql_results -%}
{%- if row["?policyName"] %}
        Policy_{{ row["?policyName"] }}["{{ row["?policyName"] }}
        ---
        Business Policy"]:::policy
{% endif -%}
{%- endfor %}
    end

{% for row in sparql_results -%}
{%- if row["?policyName"] and row["?eventName"] %}
    Event_{{ row["?eventName"] }} -.->|"Enforced by"| Policy_{{ row["?policyName"] }}
{% endif -%}
{%- endfor %}
