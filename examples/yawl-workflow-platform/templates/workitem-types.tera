---
to: "lib/types/workitems.mjs"
description: Work item types
metadata:
  category: types
---
{# =============================================================================
   WORK ITEM TYPES TEMPLATE
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
/**
 * @fileoverview YAWL Work Item Types
 * DO NOT EDIT - auto-generated by ggen sync
 * @module workitems
 */

import { z } from 'zod';

export const WorkItemStatus = {
{%- for row in sparql_results %}
{%- set statusLabel = row["?statusLabel"] | default(value="") %}
{%- if statusLabel != "" %}
  {{ statusLabel | upper }}: '{{ statusLabel | lower }}',
{%- endif %}
{%- endfor %}
};

export const WorkItemStatusSchema = z.enum([{% for row in sparql_results %}{% set statusLabel = row["?statusLabel"] | default(value="") %}{% if statusLabel != "" %}'{{ statusLabel | lower }}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}]);

export const WorkItemSchema = z.object({
  workItemId: z.string(),
  caseId: z.string(),
  taskId: z.string(),
  status: WorkItemStatusSchema,
  owner: z.string().optional(),
  startedBy: z.string().optional(),
  completedBy: z.string().optional(),
  createdAt: z.string().datetime(),
  startedAt: z.string().datetime().optional(),
  completedAt: z.string().datetime().optional(),
  timerExpiry: z.string().datetime().optional(),
  inputData: z.record(z.unknown()).default({}),
  outputData: z.record(z.unknown()).default({}),
});

export const VALID_WORKITEM_TRANSITIONS = {
  'enabled': ['fired', 'cancelled', 'suspended'],
  'fired': ['allocated', 'cancelled'],
  'allocated': ['started', 'cancelled', 'suspended'],
  'started': ['completed', 'failed', 'cancelled', 'suspended'],
  'completed': [],
  'suspended': ['enabled', 'allocated', 'started', 'cancelled'],
  'cancelled': [],
  'failed': [],
};

/**
 * Check if a work item status transition is valid
 * @param {string} from
 * @param {string} to
 * @returns {boolean}
 */
export function isValidWorkItemTransition(from, to) {
  return VALID_WORKITEM_TRANSITIONS[from]?.includes(to) ?? false;
}
