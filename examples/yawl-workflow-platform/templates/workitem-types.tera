---
to: "lib/types/workitems.ts"
description: Work item types
metadata:
  category: types
---
{# =============================================================================
   WORK ITEM TYPES TEMPLATE
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
/**
 * @fileoverview YAWL Work Item Types
 * DO NOT EDIT - auto-generated by ggen sync
 */

import { z } from 'zod';

export const WorkItemStatus = {
{%- for row in sparql_results %}
{%- set statusLabel = row["?statusLabel"] | default(value="") %}
{%- if statusLabel != "" %}
  {{ statusLabel | upper }}: '{{ statusLabel | lower }}',
{%- endif %}
{%- endfor %}
} as const;

export type WorkItemStatus = typeof WorkItemStatus[keyof typeof WorkItemStatus];

export const WorkItemSchema = z.object({
  workItemId: z.string(),
  caseId: z.string(),
  taskId: z.string(),
  status: z.enum([{% for row in sparql_results %}{% set statusLabel = row["?statusLabel"] | default(value="") %}{% if statusLabel != "" %}'{{ statusLabel | lower }}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}]),
  owner: z.string().optional(),
  startedBy: z.string().optional(),
  completedBy: z.string().optional(),
  createdAt: z.string().datetime(),
  startedAt: z.string().datetime().optional(),
  completedAt: z.string().datetime().optional(),
  timerExpiry: z.string().datetime().optional(),
  inputData: z.record(z.unknown()).default({}),
  outputData: z.record(z.unknown()).default({}),
});

export type WorkItem = z.infer<typeof WorkItemSchema>;

export const VALID_WORKITEM_TRANSITIONS: Record<WorkItemStatus, WorkItemStatus[]> = {
  'enabled': ['fired', 'cancelled', 'suspended'],
  'fired': ['allocated', 'cancelled'],
  'allocated': ['started', 'cancelled', 'suspended'],
  'started': ['completed', 'failed', 'cancelled', 'suspended'],
  'completed': [],
  'suspended': ['enabled', 'allocated', 'started', 'cancelled'],
  'cancelled': [],
  'failed': [],
};

export function isValidWorkItemTransition(from: WorkItemStatus, to: WorkItemStatus): boolean {
  return VALID_WORKITEM_TRANSITIONS[from]?.includes(to) ?? false;
}
