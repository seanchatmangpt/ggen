---
to: "generated/workflows/{{ specId }}.yawl"
description: YAWL XML workflow specification
vars:
  specId: string
  specName: string
  specVersion: string
metadata:
  category: workflow
  format: yawl-xml
  yawl_version: "4.0"
---
{# =============================================================================
   YAWL XML SPECIFICATION TEMPLATE
   Generates YAWL 4.0 XML from RDF workflow specifications
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
<?xml version="1.0" encoding="UTF-8"?>
<specificationSet xmlns="http://www.yawlfoundation.org/yawlschema"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  version="4.0"
                  xsi:schemaLocation="http://www.yawlfoundation.org/yawlschema YAWL_Schema4.0.xsd">

{%- for row in sparql_results %}
{%- set specId = row["?specId"] | default(value="") %}
{%- set specName = row["?specName"] | default(value="") %}
{%- set specVersion = row["?specVersion"] | default(value="1.0.0") %}
{%- set specComment = row["?specComment"] | default(value="") %}
{%- set inputCondition = row["?inputCondition"] | default(value="Start") %}
{%- set outputCondition = row["?outputCondition"] | default(value="End") %}
{%- set taskIds = row["?taskIds"] | default(value="") | split(pat=",") %}

  <!-- Workflow: {{ specName }} -->
  <specification uri="{{ specId }}">
    <documentation>{{ specComment }}</documentation>
    <metaData>
      <title>{{ specName }}</title>
      <version>{{ specVersion }}</version>
      <persistent>false</persistent>
      <identifier>{{ specId }}</identifier>
    </metaData>

    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
      <!-- Case-level data variables -->
      <xs:complexType name="CaseDataType">
        <xs:sequence>
          <xs:element name="caseId" type="xs:string"/>
          <xs:element name="startTime" type="xs:dateTime"/>
          <xs:element name="status" type="xs:string"/>
          <xs:element name="customData" type="xs:anyType" minOccurs="0"/>
        </xs:sequence>
      </xs:complexType>
    </xs:schema>

    <decomposition id="{{ specId }}_Net" isRootNet="true" xsi:type="NetFactsType">
      <name>{{ specName }}</name>

      <!-- Local Variables -->
      <localVariable>
        <index>0</index>
        <name>caseData</name>
        <type>CaseDataType</type>
        <namespace>http://www.w3.org/2001/XMLSchema</namespace>
        <initialValue>{"caseId": "", "startTime": "", "status": "active"}</initialValue>
      </localVariable>

      <!-- Process Control Flow -->
      <processControlElements>

        <!-- Input Condition -->
        <inputCondition id="InputCondition_{{ specId }}">
          <name>{{ inputCondition }}</name>
          <documentation>Start of {{ specName }}</documentation>
        </inputCondition>

        {# Tasks will be generated in a separate query for detailed task data #}
        {%- for taskId in taskIds %}
        {%- if taskId != "" %}
        <!-- Task: {{ taskId }} -->
        <task id="{{ taskId }}">
          <name>{{ taskId | replace(from="-", to=" ") | title }}</name>
          <flowsInto>
            <nextElementRef id="OutputCondition_{{ specId }}"/>
          </flowsInto>
          <join code="xor"/>
          <split code="and"/>
          <decomposesTo id="{{ taskId }}_Decomposition"/>
        </task>
        {%- endif %}
        {%- endfor %}

        <!-- Output Condition -->
        <outputCondition id="OutputCondition_{{ specId }}">
          <name>{{ outputCondition }}</name>
          <documentation>End of {{ specName }}</documentation>
        </outputCondition>

      </processControlElements>
    </decomposition>

    {# Task Decompositions #}
    {%- for taskId in taskIds %}
    {%- if taskId != "" %}
    <decomposition id="{{ taskId }}_Decomposition" xsi:type="WebServiceGatewayFactsType">
      <name>{{ taskId | replace(from="-", to=" ") | title }} Service</name>
      <externalInteraction>manual</externalInteraction>
    </decomposition>
    {%- endif %}
    {%- endfor %}

  </specification>
{%- endfor %}

</specificationSet>
