---
to: "lib/types/cases.mjs"
description: Case management types
metadata:
  category: types
---
{# =============================================================================
   CASE TYPES TEMPLATE
   DO NOT EDIT - auto-generated by ggen sync
   ============================================================================= #}
/**
 * @fileoverview YAWL Case Management Types
 * DO NOT EDIT - auto-generated by ggen sync
 * @module cases
 */

import { z } from 'zod';

export const CaseStatus = {
{%- for row in sparql_results %}
{%- set statusLabel = row["?statusLabel"] | default(value="") %}
{%- if statusLabel != "" %}
  {{ statusLabel | upper }}: '{{ statusLabel | lower }}',
{%- endif %}
{%- endfor %}
};

export const CaseStatusSchema = z.enum([{% for row in sparql_results %}{% set statusLabel = row["?statusLabel"] | default(value="") %}{% if statusLabel != "" %}'{{ statusLabel | lower }}'{% if not loop.last %}, {% endif %}{% endif %}{% endfor %}]);

export const CaseSchema = z.object({
  caseId: z.string(),
  specId: z.string(),
  status: CaseStatusSchema,
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime().optional(),
  completedAt: z.string().datetime().optional(),
  caseData: z.record(z.unknown()).default({}),
  parentCaseId: z.string().optional(),
  lastSuccessfulTaskId: z.string().optional(),
});

export const VALID_CASE_TRANSITIONS = {
{%- for row in sparql_results %}
{%- set statusLabel = row["?statusLabel"] | default(value="") %}
{%- if statusLabel != "" %}
{%- if statusLabel == "Active" %}
  '{{ statusLabel | lower }}': ['completed', 'cancelled', 'failed', 'suspended'],
{%- elif statusLabel == "Suspended" %}
  '{{ statusLabel | lower }}': ['active', 'cancelled'],
{%- else %}
  '{{ statusLabel | lower }}': [],
{%- endif %}
{%- endif %}
{%- endfor %}
};

/**
 * Check if a case status transition is valid
 * @param {string} from
 * @param {string} to
 * @returns {boolean}
 */
export function isValidTransition(from, to) {
  return VALID_CASE_TRANSITIONS[from]?.includes(to) ?? false;
}
