/**
 * @fileoverview YAWL Case Management Types
 * DO NOT EDIT - auto-generated by ggen sync
 * @module cases
 */

import { z } from 'zod';

export const CaseStatus = {
  ACTIVE: 'active',
  CANCELLED: 'cancelled',
  COMPLETED: 'completed',
  FAILED: 'failed',
  SUSPENDED: 'suspended',
};

export const CaseStatusSchema = z.enum(['active', 'cancelled', 'completed', 'failed', 'suspended']);

export const CaseSchema = z.object({
  caseId: z.string(),
  specId: z.string(),
  status: CaseStatusSchema,
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime().optional(),
  completedAt: z.string().datetime().optional(),
  caseData: z.record(z.unknown()).default({}),
  parentCaseId: z.string().optional(),
  lastSuccessfulTaskId: z.string().optional(),
});

export const VALID_CASE_TRANSITIONS = {
  'active': ['completed', 'cancelled', 'failed', 'suspended'],
  'cancelled': [],
  'completed': [],
  'failed': [],
  'suspended': ['active', 'cancelled'],
};

/**
 * Check if a case status transition is valid
 * @param {string} from
 * @param {string} to
 * @returns {boolean}
 */
export function isValidTransition(from, to) {
  return VALID_CASE_TRANSITIONS[from]?.includes(to) ?? false;
}
