[project]
name = "ggen-documentation-generation"
version = "5.0.2"
description = "Generate ggen documentation from RDF ontology"

[generation]
ontology_dir = ".specify/specs/999-docs-as-code/"
templates_dir = ".specify/specs/999-docs-as-code/templates/"
output_dir = "docs/"

[generation.poka_yoke]
warning_headers = false
gitignore_generated = false

# INFERENCE RULES: Materialize documentation structure

[[inference.rules]]
name = "guide_hierarchy"
description = "Find all guides with their properties"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {
  ?guide doc:outputFile ?file ;
         doc:template ?template ;
         doc:type "Guide" .
}
WHERE {
  ?guide a doc:Guide ;
    doc:outputFile ?file ;
    doc:template ?template .
}
"""

[[inference.rules]]
name = "reference_hierarchy"
description = "Find all references with their properties"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {
  ?ref doc:outputFile ?file ;
       doc:template ?template ;
       doc:type "Reference" .
}
WHERE {
  ?ref a doc:Reference ;
    doc:outputFile ?file ;
    doc:template ?template .
}
"""

[[inference.rules]]
name = "gap_priority"
description = "Group gaps by priority"
query = """
PREFIX doc: <https://ggen.example.com/docs/>

CONSTRUCT {
  ?gap doc:priorityGroup ?priority .
}
WHERE {
  ?gap doc:priority ?priority .
}
"""

rule_order = ["guide_hierarchy", "reference_hierarchy", "gap_priority"]

# GENERATION RULES: Render documentation

[[generation.rules]]
name = "guides"
description = "Generate all guides"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
SELECT ?title ?description ?pages ?effort ?outputFile ?template
WHERE {
  ?guide a doc:Guide ;
    doc:title ?title ;
    doc:description ?description ;
    doc:pages ?pages ;
    doc:effort ?effort ;
    doc:outputFile ?outputFile ;
    doc:template ?template .
}
"""
template = "generate-guides.tera"
output_file = "GENERATED_GUIDES_MANIFEST.txt"

[[generation.rules]]
name = "references"
description = "Generate all references"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
SELECT ?title ?description ?pages ?effort ?outputFile ?template
WHERE {
  ?ref a doc:Reference ;
    doc:title ?title ;
    doc:description ?description ;
    doc:pages ?pages ;
    doc:effort ?effort ;
    doc:outputFile ?outputFile ;
    doc:template ?template .
}
"""
template = "generate-references.tera"
output_file = "GENERATED_REFERENCES_MANIFEST.txt"

[[generation.rules]]
name = "gaps"
description = "Generate gap analysis"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
SELECT ?title ?description ?priority ?effort ?category
WHERE {
  ?gap doc:title ?title ;
    doc:description ?description ;
    doc:priority ?priority ;
    doc:effort ?effort ;
    doc:category ?category .
}
ORDER BY ?priority
"""
template = "generate-gap-analysis.tera"
output_file = "GENERATED_GAP_ANALYSIS.md"

[[generation.rules]]
name = "index"
description = "Generate documentation index"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
SELECT ?title ?description ?pages ?category ?outputFile
WHERE {
  ?doc doc:title ?title ;
    doc:description ?description ;
    doc:pages ?pages ;
    doc:category ?category ;
    doc:outputFile ?outputFile .
}
ORDER BY ?category ?title
"""
template = "generate-index.tera"
output_file = "GENERATED_INDEX.md"

[[generation.rules]]
name = "todos"
description = "Generate todo list from gaps"
query = """
PREFIX doc: <https://ggen.example.com/docs/>
SELECT ?title ?description ?priority ?effort
WHERE {
  ?gap doc:title ?title ;
    doc:description ?description ;
    doc:priority ?priority ;
    doc:effort ?effort .
}
ORDER BY ?priority ?effort
"""
template = "generate-todos.tera"
output_file = "GENERATED_TODOS.md"
